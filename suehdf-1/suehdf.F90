SUBROUTINE SUEHDF 

IMPLICIT NONE

INTEGER(KIND=4) :: IM, IN, JLEV, JMLOC, JN

REAL (KIND=8), ALLOCATABLE :: RDIVORE (:, :), RDIDIVE (:, :)

INTEGER, PARAMETER, DIMENSION (*) ::  MYMS = [ &
&           0,           1,           2,           3,           4,           5, &           
&           6,           7,           8,           9,          10,          11, &          
&          12,          13,          14,          15,          16,          17, &          
&          18,          19,          20,          21,          22,          23, &          
&          24,          25,          26,          27,          28,          29]

INTEGER, PARAMETER, DIMENSION (*) :: NCPLM = [ &
&          30,          29,          29,          29,          29,          29, &          
&          29,          29,          28,          28,          28,          27, &          
&          27,          26,          26,          25,          25,          24, &          
&          23,          22,          22,          21,          19,          18, &          
&          17,          15,          13,          11,           8,           1]

INTEGER, PARAMETER, DIMENSION (*) ::  NPME = [ &
&           1,          31,          60,          89,         118,         147, &
&         176,         205,         234,         262,         290,         318, &
&         345,         372,         398,         424,         449,         474, &
&         498,         521,         543,         565,         586,         605, &
&         623,         640,         655,         668,         679,         687]

INTEGER :: INMSHDI (90), INSHDI (90)

REAL(KIND=8) :: Z_PDILEV(90)
REAL(KIND=8) :: REXPDH

REAL(KIND=8) :: BDISPE
INTEGER(KIND=4) :: KNSMAX, KNMSMAX, KN, KM
REAL(KIND=8) :: PEXPDH
REAL(KIND=8) :: ZRANDH
LOGICAL :: LLOPENMMP
CHARACTER*8 :: CLENV

BDISPE(KM,KN,KNMSMAX,KNSMAX,PEXPDH)=MAX(0.0_8,( ( SQRT(&
 & REAL(KM,8)**2/MAX(0.5_8,REAL(KNMSMAX,8))**2&
 & + REAL(KN,8)**2/MAX(0.5_8,REAL(KNSMAX,8))**2)&
 &- ZRANDH )/( 1.0_8-ZRANDH ) ) )**PEXPDH

ZRANDH = 0.000000000000000

CALL GETENV ('OPENMP', CLENV)
LLOPENMMP = CLENV == '1'

ALLOCATE (RDIVORE (90, 687), RDIDIVE (90, 687))

RDIVORE = 0
RDIDIVE = 0

INSHDI = 29
INMSHDI = 29

Z_PDILEV = [ &
&   167.7392296617526_8, 31.74843705943004_8, 23.60923367877540_8, &
&   18.37689227732537_8, 14.86575578557662_8, 12.41377951547656_8, &
&   10.63169386222125_8, 9.286977527410711_8, 8.236860525065140_8, &
&   7.391900224852958_8, 6.697681238831237_8, 6.119401636635867_8, &
&   5.631204878892754_8, 5.213663929806979_8, 4.852049130749949_8, &
&   4.535202866280226_8, 4.255688141655284_8, 4.007891766567118_8, &
&   3.786576978953074_8, 3.587580251831063_8, 3.407633787231370_8, &
&   3.244173066586477_8, 3.095190812160924_8, 2.959124961088452_8, &
&   2.834772079184638_8, 2.721220223784126_8, 2.617410215697434_8, &
&   2.522118023249914_8, 2.434299119442195_8, 2.353059374492083_8, &
&   2.277631418494739_8, 2.207355333276318_8, 2.141662784056577_8, &
&   2.080063904300038_8, 2.022136391681815_8, 1.967516391220095_8, &
&   1.915890825590965_8, 1.867004962879344_8, 1.820650529648647_8, &
&   1.776642303595379_8, 1.734815589461786_8, 1.695024013021543_8, &
&   1.657137592833992_8, 1.621041050329154_8, 1.586632326744050_8, &
&   1.553821278413889_8, 1.522528528875698_8, 1.492684458056535_8, &
&   1.464228315697973_8, 1.437107439597041_8, 1.411276571382500_8, &
&   1.386692613413735_8, 1.363310551446276_8, 1.341084331997611_8, &
&   1.319967091034502_8, 1.299911335155472_8, 1.280869080244741_8, &
&   1.262791953375184_8, 1.245631261866055_8, 1.229338033751208_8, &
&   1.213863037192923_8, 1.199156775256713_8, 1.185169465656590_8, &
&   1.171851010692659_8, 1.159168861516362_8, 1.147107438183057_8, &
&   1.135650117995937_8, 1.124779320026666_8, 1.114476573189439_8, &
&   1.104722569398064_8, 1.095497202806308_8, 1.086779596960888_8, &
&   1.078548120286090_8, 1.070780391566046_8, 1.063453276063306_8, &
&   1.056542875775850_8, 1.050024510288339_8, 1.043886167240682_8, &
&   1.038128953389417_8, 1.032754254423476_8, 1.027763755398976_8, &
&   1.023159461845780_8, 1.018943721900875_8, 1.015119248793538_8, &
&   1.011689144514828_8, 1.008656924739560_8, 1.006026544767032_8, &
&   1.003802426464601_8, 1.001989488103847_8, 1.000593173715472_8]

REXPDH = 4.000000000000000_8

!$OMP PARALLEL DO &
!$OMP& PRIVATE(JLEV,JMLOC,JN,IM,IN) IF (LLOPENMMP)
DO JLEV=1,90
  DO JMLOC=1,30
    IM=MYMS(JMLOC)
    DO JN=0,NCPLM(IM)-1
      IN=NPME(IM)+JN
      RDIVORE(JLEV,IN)=Z_PDILEV(JLEV)*BDISPE(IM,JN,INMSHDI(JLEV),INSHDI(JLEV),REXPDH)
      RDIDIVE(JLEV,IN)=Z_PDILEV(JLEV)*BDISPE(IM,JN,INMSHDI(JLEV),INSHDI(JLEV),REXPDH)
    ENDDO 
  ENDDO 
ENDDO 
!$OMP END PARALLEL DO

OPEN (77, FORM="FORMATTED", FILE="RDIVORE.txt")
WRITE (77, '(10E30.20)') RDIVORE
CLOSE (77)

OPEN (77, FORM="FORMATTED", FILE="RDIDIVE.txt")
WRITE (77, '(10E30.20)') RDIDIVE
CLOSE (77)

END SUBROUTINE SUEHDF

