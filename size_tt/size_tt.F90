PROGRAM MAIN

IMPLICIT NONE

TYPE TT
  REAL :: X
END TYPE

TYPE (TT), POINTER :: YY (:)

ALLOCATE (YY (1))

PRINT *, SIZE_TT (YY)

CONTAINS

INTEGER FUNCTION SIZE_TT (YD, KDIM) RESULT (KSIZE)

TYPE (TT), POINTER :: YD (:)
INTEGER, OPTIONAL :: KDIM

KSIZE = 0

IF (ASSOCIATED (YD)) THEN
  KSIZE = SIZE (YD, KDIM)
ENDIF

END FUNCTION

END
